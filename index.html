<!doctype html>
<meta charset="utf-8">
<style>

.tooltip {
  position: absolute;
  text-align: center;
  width: 360px;
  height: 12px;
  padding: 8px;
  margin-top: -20px;
  font: 15px sans-serif;
  pointer-events: none;
  background: rgba(255, 255, 255, .8);
}

</style>
<html>
<script src="https://d3js.org/d3.v5.min.js"></script>
  <head>
    <title>World Suicide Rate from 1985~2016</title>
  </head>
  <body>
    <h1>World Suicide Rate from 1985~2016 </h1>
    <p>Which Country Do You Think Has The Highest Suicide Rate?</p>
    <p>List of Suicide Rates per country (per 100k Population)</p>
    <script type="text/javascript">
		// Set the dimensions of the canvas / graph

    	var width = 1080;
    	var height = 3000;
    	var svg = d3.select("body")
                	.append("svg")
               		.attr("width", width);
        var div = d3.select("body").append("div")
                    .attr("class", "tooltip")
                    .style("display", "none");
        
    	d3.csv("data/100kPop_per_country.csv").then(function(data) {
    		console.log(data);
    		data = data.reverse();
        	var maxdata = data[0].Suicides_per_100KPop;
        	var textlen = 200;
        	console.log('max country', data[0].Country)
        	var xs = d3.scaleLinear().domain([0, parseFloat(maxdata) + 100]).range([0, width-textlen]);
        	var height = 20 * data.length;

        	svg.attr("height", height + 30)

    		svg.selectAll("rect")
    	    	.data(data)
    	    	.enter()
    	    	.append("rect")
    	    		.attr("x", textlen)
    	    		.attr("y", function(d, i) {return i * 20 + 20;})
    	    		.attr("width", function(d) {return xs(d.Suicides_per_100KPop) ;})
    	    		.attr("height", 18)
    	    		.attr("fill", d3.color("steelblue"))
    	    		.on("mouseover", function(d) {
                        d3.select(this).attr("stroke", "black");
                        div.transition().duration(300).style("opacity", 0.9).style("display", "inline");
    	    			div.html(d.Country + " Suicide Rate:" + d.Suicides_per_100KPop + " pp")
                            .style("display", "inline")
    	    				.style("left", d3.event.pageX + 50 + "px")
    	    				.style("top", d3.event.pageY +20 + "px");
    	    		})
    	    		.on("mouseout", function(d) {	
                        d3.select(this).attr("stroke", "none");	
            			div.transition()		
                			.duration(500)		
                            .style("opacity", 0)
                			.style("display", "none");	
                	});
    	    
    	    svg.selectAll("text")
    	    	.data(data)
    	    	.enter()
    	    	.append("text")
    	    		.attr("x", 10)
    	    		.attr("y", function(d, i) {return i * 20 + 35;})
    	    		.text(function(d) {return d.Country;})
    	    		.attr("font-size", "17px")
    	    		.attr("fill", "black");


    	});

    	
    </script>
  </body>
  

</html>
